@model IEnumerable<SistemaContable.Models.Impresora>

@{
    ViewData["Title"] = "Impresoras";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">@ViewData["Title"]</h3>
                    <div class="card-tools">
                        <a asp-action="Create" class="btn" style="background:#3944BC;color:#FFFFFF;">
                            <i class="fas fa-plus me-1"></i> Nueva Impresora
                        </a>
                    </div>
                </div>
                <div class="card-body">
                    @if (TempData["SuccessMessage"] != null)
                    {
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-check-circle me-2"></i>
                                <span>¡Éxito!</span>
                            </div>
                            <p class="mb-0 mt-1">@TempData["SuccessMessage"]</p>
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close" onclick="$(this).parent().fadeOut();"></button>
                        </div>
                    }

                    @if (TempData["InfoMessage"] != null)
                    {
                        <div class="alert alert-info alert-dismissible">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <h5><i class="icon fas fa-info"></i> Información</h5>
                            @TempData["InfoMessage"]
                        </div>
                    }

                    @if (ViewBag.SugerirCambiarPestana == true)
                    {
                        <div class="alert alert-info alert-dismissible">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <h5><i class="icon fas fa-info"></i> Información</h5>
                            No hay impresoras @(ViewBag.Tab == "Activos" ? "activas" : "inactivas"). 
                            <a asp-action="Index" asp-route-tab="@ViewBag.HayImpresorasEnOtraPestana" class="alert-link">
                                Ver impresoras @(ViewBag.HayImpresorasEnOtraPestana == "Activos" ? "activas" : "inactivas")
                            </a>
                        </div>
                    }

                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="/">Dashboard</a></li>
                            <li class="breadcrumb-item">Punto de Venta</li>
                            <li class="breadcrumb-item active" aria-current="page">Impresoras</li>
                        </ol>
                    </nav>

                    <ul class="nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link @(ViewBag.Tab == "Activos" ? "active" : "")" 
                               asp-action="Index" asp-route-tab="Activos" role="tab">
                                Activos
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link @(ViewBag.Tab == "Inactivos" ? "active" : "")" 
                               asp-action="Index" asp-route-tab="Inactivos" role="tab">
                                Inactivos
                            </a>
                        </li>
                    </ul>

                    <div class="tab-content mt-3">
                        <div class="tab-pane fade show active">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover" id="tablaImpresoras">
                                    <thead>
                                        <tr style="background-color: #f8f9fa;">
                                            <th>NOMBRE</th>
                                            <th>MODELO</th>
                                            <th>RUTAS FÍSICAS</th>
                                            <th>ESTADO</th>
                                            <th>ACCIÓN</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var item in Model)
                                        {
                                            <tr>
                                                <td>@item.Nombre</td>
                                                <td>@item.Modelo</td>
                                                <td>@item.RutasFisicas</td>
                                                <td>
                                                    <span class="badge @(item.Estado ? "bg-success" : "bg-danger")">
                                                        @(item.Estado ? "Activo" : "Inactivo")
                                                    </span>
                                                </td>
                                                <td>
                                                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-icon btn-flat-primary">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit">
                                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                                        </svg>
                                                    </a>
                                                    <a href="#" onclick="confirmarCambioEstado(@item.Id, '@item.Nombre', @item.Estado.ToString().ToLower()); return false;" class="btn btn-icon btn-flat-danger">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-trash-2">
                                                            <polyline points="3 6 5 6 21 6"></polyline>
                                                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                                        </svg>
                                                    </a>
                                                    <a asp-action="Test" asp-route-id="@item.Id" class="btn btn-icon btn-flat-secondary">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-printer">
                                                            <polyline points="6 9 6 2 18 2 18 9"></polyline>
                                                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                                                            <rect x="6" y="14" width="12" height="8"></rect>
                                                        </svg>
                                                    </a>
                                                </td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#tablaImpresoras').DataTable({
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json',
                    lengthMenu: 'Mostrar _MENU_ registros',
                    paginate: {
                        first: '<i class="fas fa-angle-double-left"></i>',
                        previous: '<i class="fas fa-angle-left"></i>',
                        next: '<i class="fas fa-angle-right"></i>',
                        last: '<i class="fas fa-angle-double-right"></i>'
                    }
                },
                pageLength: 10,
                order: [[0, 'asc']],
                lengthMenu: [
                    [10, 25, 50, 100, -1],
                    ['10', '25', '50', '100', 'Todos']
                ],
                dom: "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>" +
                     "<'row'<'col-sm-12'tr>>" +
                     "<'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>"
            });
        });

        function confirmarCambioEstado(id, nombre, estado) {
            document.getElementById('impresoraId').value = id;
            var accion = estado ? 'desactivar' : 'activar';
            document.getElementById('mensajeConfirmacion').textContent = 
                `¿Está seguro que desea ${accion} la impresora "${nombre}"?`;
            var modal = new bootstrap.Modal(document.getElementById('modalConfirmacion'));
            modal.show();
        }
    </script>
}

<style>
    /* Estilos para los botones de acción */
    .btn-icon {
        padding: 0.5rem;
        margin: 0 0.125rem;
        border-radius: 0.25rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .btn-flat-primary {
        color: #EC5800;
        background-color: rgba(236, 88, 0, 0.12);
        border: none;
    }
    
    .btn-flat-primary:hover {
        background-color: rgba(236, 88, 0, 0.2);
        color: #EC5800;
    }
    
    .btn-flat-danger {
        color: #ea5455;
        background-color: rgba(234, 84, 85, 0.12);
        border: none;
    }
    
    .btn-flat-danger:hover {
        background-color: rgba(234, 84, 85, 0.2);
        color: #ea5455;
    }
    
    .btn-flat-secondary {
        color: #82868b;
        background-color: rgba(130, 134, 139, 0.12);
        border: none;
    }
    
    .btn-flat-secondary:hover {
        background-color: rgba(130, 134, 139, 0.2);
        color: #82868b;
    }
    
    .feather {
        font-family: feather!important;
        speak: none;
        font-style: normal;
        font-weight: 400;
        font-variant: normal;
        text-transform: none;
        line-height: 1;
        -webkit-font-smoothing: antialiased;
    }
    
    /* Estilos para pestañas sin bordes */
    .nav-link {
        border: none !important;
    }
    
    .nav-link.active {
        border-bottom: 2px solid #007bff !important;
        border-left: none !important;
        border-right: none !important;
        border-top: none !important;
    }
    
    /* Estilos para los botones de paginación */
    .page-item.active .page-link {
        background-color: #3944BC !important;
        border-color: #3944BC !important;
        color: white !important;
    }
    .page-link {
        color: #333 !important;
    }
    .page-link:hover {
        color: #3944BC !important;
    }
    /* Estilos para botones de Anterior/Siguiente */
    .dataTables_paginate .paginate_button.previous,
    .dataTables_paginate .paginate_button.next {
        background-color: #f8f9fa !important;
        border-color: #dee2e6 !important;
    }
    /* Estilo para el botón activo */
    .dataTables_paginate .paginate_button.current {
        background-color: #3944BC !important;
        border-color: #3944BC !important;
        color: white !important;
    }
</style> 